SELECT * FROM events WHERE devicetype=12 AND (LOWER("Process Path") LIKE '%\coregen.exe' OR LOWER("Process Name") LIKE '%\coregen.exe') AND NOT((LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\windows\system32\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\windows\syswow64\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files\microsoft silverlight\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files (x86)\microsoft silverlight\%'))