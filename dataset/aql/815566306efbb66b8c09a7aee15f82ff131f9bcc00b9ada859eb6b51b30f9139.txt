SELECT * FROM events WHERE devicetype=12 AND LOWER(CONCAT('file directory', '/', filename)) LIKE '%\amsi.dll' AND NOT(("Process Path" IN('C:\Windows\explorer.exe', 'C:\Windows\Sysmon64.exe') OR "Process Name" IN('C:\Windows\explorer.exe', 'C:\Windows\Sysmon64.exe') OR LOWER("Process Path") LIKE 'c:\program files (x86)\%' OR LOWER("Process Path") LIKE 'c:\program files\%' OR LOWER("Process Path") LIKE 'c:\windows\system32\%' OR LOWER("Process Path") LIKE 'c:\windows\syswow64\%' OR LOWER("Process Path") LIKE 'c:\windows\winsxs\%' OR LOWER("Process Name") LIKE 'c:\program files (x86)\%' OR LOWER("Process Name") LIKE 'c:\program files\%' OR LOWER("Process Name") LIKE 'c:\windows\system32\%' OR LOWER("Process Name") LIKE 'c:\windows\syswow64\%' OR LOWER("Process Name") LIKE 'c:\windows\winsxs\%' OR (LOWER("Process Path") LIKE 'c:\programdata\microsoft\windows defender\platform\%' OR LOWER("Process Name") LIKE 'c:\programdata\microsoft\windows defender\platform\%') AND (LOWER("Process Path") LIKE '%\msmpeng.exe' OR LOWER("Process Name") LIKE '%\msmpeng.exe') OR (LOWER("Process Path") LIKE 'c:\windows\microsoft.net\framework\%' OR LOWER("Process Path") LIKE 'c:\windows\microsoft.net\framework64\%' OR LOWER("Process Name") LIKE 'c:\windows\microsoft.net\framework\%' OR LOWER("Process Name") LIKE 'c:\windows\microsoft.net\framework64\%') AND (LOWER("Process Path") LIKE '%\ngentask.exe' OR LOWER("Process Name") LIKE '%\ngentask.exe') OR "Process Path" IS NULL OR "Process Name" IS NULL OR "Process Path"='' OR "Process Name"=''))