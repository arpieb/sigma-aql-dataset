SELECT * FROM events WHERE devicetype=12 AND LOWER(CONCAT('file directory', '/', filename)) LIKE '%\commfunc.dll' AND NOT((LOWER(CONCAT('file directory', '/', filename)) LIKE '%\appdata\local\google\chrome\application\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files\lenovo\communications utility\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files (x86)\lenovo\communications utility\%')) OR LOWER(CONCAT('file directory', '/', filename)) LIKE '%\tosbtkbd.dll' AND NOT((LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files\toshiba\bluetooth toshiba stack\%' OR LOWER(CONCAT('file directory', '/', filename)) LIKE 'c:\program files (x86)\toshiba\bluetooth toshiba stack\%'))