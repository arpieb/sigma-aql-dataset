author: Nasreddine Bencherchali (Nextron Systems)
date: '2023-06-01'
description: Detects the creation of the "PSScriptPolicyTest" PowerShell script by
  an uncommon process. This file is usually generated by Microsoft Powershell to test
  against Applocker.
detection:
  condition: selection and not 1 of filter_main_*
  filter_main_generic:
    Image|endswith:
    - :\Program Files\PowerShell\7-preview\pwsh.exe
    - :\Program Files\PowerShell\7\pwsh.exe
    - :\Windows\System32\dsac.exe
    - :\Windows\System32\ServerManager.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    - :\Windows\System32\wsmprovhost.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe
  selection:
    TargetFilename|contains: __PSScriptPolicyTest_
falsepositives:
- Unknown
id: 1027d292-dd87-4a1a-8701-2abe04d7783c
level: medium
logsource:
  category: file_event
  product: windows
references:
- https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/
status: experimental
tags:
- attack.defense_evasion
title: PSScriptPolicyTest Creation By Uncommon Process
